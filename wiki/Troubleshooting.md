# 问题排查

常见问题与解决思路。

## 基本探活

- 调用 `check_connection`：返回 `{ok: True, count: n}` 表示至少有 n 个实例。
- `curl http://127.0.0.1:11337/instances` 验证协调器接口。

## 连接失败

| 现象 | 可能原因 | 处理 |
|------|----------|------|
| Connection refused (实例端口) | 插件未启动 / 端口已被其它程序占用 | 在 IDA 中重新点击插件；确认防火墙配置 |
| /call 返回 instance not found | 端口或 pid 不存在于注册表 | 重新启动该实例插件以刷新注册 |
| 超时 | 目标实例执行长耗时分析或卡死 | 重试前确认 IDA 未卡死；必要时重启实例 |
| 代理工具全部报错 | 协调器未启动（首实例未成功注册） | 关闭所有实例，重新启动一个新实例加载插件 |

## 函数列表为空

- IDA 自动分析未完成：等待进度条结束。
- binary 几乎无代码：确认是否是数据文件或加壳文件。

## search_instances 无结果

- 关键字不匹配 basename：尝试去掉路径、只输入核心文件名部分。

## check_connection 一直为 False

- 所有实例已关闭但残留旧进程：终止僵尸 IDA 进程再重新启动。
- 协调器线程异常退出：全部关闭后重新启动首个实例。

## 如何确认协调器是哪一个实例

- 查看 `instances` 列表中最早 `started` 的记录；该实例最可能持有 11337。
- 若需要强制迁移：关闭它，其它实例重新注册会有新首实例成为协调器。

## 大数据返回缓慢

- list_functions 在超大型程序上 JSON 序列化耗时明显。
- 规避方案：后续引入分页，或临时在代码内过滤只返回前 N 条调试。

## 下一步调试

- 在 `registry.py` 的 /call 加打印；重试调用确认路径。
- 使用 Python fastmcp.Client 做最小复现，排除 MCP 客户端 UI 影响。

返回首页: [Home](Home.md)
